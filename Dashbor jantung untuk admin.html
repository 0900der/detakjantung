<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‚ù§Ô∏è HeartBeat Monitor - Kelompok 1</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root { --bg: #0a0a1a; --card: #1e1e30; --primary: #ff4458; --text: #eee; }
    body { background: var(--bg); color: var(--text); font-family: 'Poppins', sans-serif; }
    .card { background: var(--card); border-radius: 15px; border: 1px solid #333; }
    .btn-primary { background: var(--primary); border: none; }
    .pulse { animation: pulse 1s infinite; color: var(--primary); }
    @keyframes pulse { 0%{transform:scale(1)} 50%{transform:scale(1.1)} 100%{transform:scale(1)} }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark" style="background:rgba(30,30,48,0.9);">
    <div class="container">
      <a class="navbar-brand" href="#"><i class="fas fa-heartbeat pulse"></i> HeartBeat Monitor</a>
    </div>
  </nav>

  <!-- Hero -->
  <div class="container py-5 text-center">
    <h1>üè• Monitoring Detak Jantung Real-Time</h1>
    <p class="lead">Oleh Kelompok 1 | Proyek IoT Kesehatan</p>
  </div>

  <!-- Admin Panel -->
  <div class="container mb-5">
    <div class="row">
      <!-- Tambah Pasien -->
      <div class="col-md-5">
        <div class="card p-4">
          <h5><i class="fas fa-user-plus"></i> Tambah Pasien</h5>
          <form onsubmit="addPatient(event)">
            <input type="text" id="name" class="form-control mb-2" placeholder="Nama" required>
            <input type="text" id="id" class="form-control mb-2" placeholder="ID (contoh: PAS001)" required>
            <input type="number" id="age" class="form-control mb-2" placeholder="Usia" required>
            <input type="text" id="room" class="form-control mb-2" placeholder="Ruangan">
            <button type="submit" class="btn btn-primary w-100">‚ûï Tambahkan</button>
          </form>
        </div>
      </div>

      <!-- Live Monitor -->
      <div class="col-md-7">
        <div class="card p-4 text-center">
          <h5 id="monitor-name">Belum ada pasien terpilih</h5>
          <div style="font-size: 4rem; font-weight: bold; color: var(--primary);" id="bpm">--</div>
          <div>Status: <span id="status">Menunggu...</span></div>
          <canvas id="chart" class="mt-3" height="100"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Daftar Pasien -->
  <div class="container">
    <h4><i class="fas fa-users"></i> Daftar Pasien</h4>
    <table class="table table-dark table-striped rounded">
      <thead><tr><th>Nama</th><th>ID</th><th>Usia</th><th>Ruangan</th><th>Aksi</th></tr></thead>
      <tbody id="patientList"></tbody>
    </table>
  </div>

  <!-- Footer -->
  <footer class="py-4 text-center opacity-75">
    &copy; 2025 Kelompok 1 | <a href="/pasien.html" target="_blank" style="color:#ff6b7a;">‚û°Ô∏è Akses sebagai Pasien</a>
  </footer>

  <!-- Script -->
  <script>
    // Simulasi BPM
    let bpm = 75;
    function updateBPM() {
      bpm += (Math.random() - 0.5) * 6;
      if (bpm < 60) bpm = 60;
      if (bpm > 100) bpm = 100;

      if (document.getElementById('bpm').textContent !== '--') {
        document.getElementById('bpm').textContent = Math.round(bpm);
        document.getElementById('status').textContent = "Stabil";

        chart.data.labels.push(new Date().toLocaleTimeString());
        chart.data.datasets[0].data.push(bpm);
        if (chart.data.labels.length > 20) {
          chart.data.labels.shift();
          chart.data.datasets[0].data.shift();
        }
        chart.update();
      }

      setTimeout(updateBPM, 1200);
    }

    // Chart JS
    const ctx = document.getElementById('chart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: Array(20).fill(''),
        datasets: [{
          data: Array(20).fill(null),
          borderColor: '#ff4458',
          backgroundColor: 'rgba(255,68,88,0.1)',
          tension: 0.4,
          fill: true
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: { y: { min: 50, max: 120 }, x: { display: false } }
      }
    });

    // Manajemen Pasien
    const patients = [];
    function addPatient(e) {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const id = document.getElementById('id').value;
      const age = document.getElementById('age').value;
      const room = document.getElementById('room').value;

      patients.push({ name, id, age, room });
      updatePatientTable();
      document.getElementById('name').value = '';
      document.getElementById('id').value = '';
      document.getElementById('age').value = '';
      document.getElementById('room').value = '';
    }

    function updatePatientTable() {
      const list = document.getElementById('patientList');
      list.innerHTML = '';
      patients.forEach(p => {
        list.innerHTML += `
          <tr>
            <td>${p.name}</td>
            <td>${p.id}</td>
            <td>${p.age}</td>
            <td>${p.room || '-'}</td>
            <td>
              <button class="btn btn-sm btn-success" onclick="selectPatient('${p.name} (${p.id})')">
                <i class="fas fa-eye"></i> Pantau
              </button>
            </td>
          </tr>`;
      });
    }

    function selectPatient(name) {
      document.getElementById('monitor-name').textContent = `Memantau: ${name}`;
      document.getElementById('bpm').textContent = '--';
      setTimeout(() => {
        updateBPM(); // Mulai grafik setelah dipilih
      }, 500);
    }
  </script>
</body>
</html>